---
title: 计算机网络课程笔记（更新中）
date: 2018-9-1 20:51:13
tags: 
    - 计算机网络 
    - 大三上笔记

categories: 
  - archives
---

# 计算机网络

## 简介

- 网络通信是进程间的通信，进程的表示：

  ```
  IP:port		//IP为服务器IP地址，port为服务器上的进程号
  ```

<!-- more -->

- 网络组成：

  - Management

  - Application

  - Hardware

    > Cable：电缆、光纤
    >
    > Network Interface Card：网卡
    >
    > Switch：交换机
    >
    > Router：路由器

## 传播介质（第7章）

### 对传播介质的度量

- 传播延时

  > 信号在介质中往返一次所需的时间

- 信道容量

  > 介质可以支持的最大数据速率

- 频率范围

  > 介质可接受的最大的频率变化范围

- 带宽

  > 每秒所收到的数据量（Bit）

### 奈奎斯特定理

```
D=2*B*log2K
K:传输系统使用的信号电平数
B:模拟带宽
D:以每秒位元数计算的最大数据速率
```

### 香农定理

```
C=B*log2(1+S/N)
B:硬件带宽
S/N:信噪比
C:用每秒位数表示的对信道容量的有效限制
```

- 分贝(db)和信噪比(S/N)是指数关系

  ```
  dB=10*log10S/N
  
  eg:
  	dB = 20 => S/N = 100
  	db = 30 => S/N = 1000
  ```

- 例子：电话线

  ```
  Bandwidth = 3000HZ
  S/N ratio = 30db
  =>  C = 30Kps
  ```

## 传输模式（第9章）

### 传输模式分类

- 串行传输
- 并行传输

### 传输数据

> 例子：Byte 正序(big-endian) && Bit 逆序(little-endian)

#### 串行传输方式

- 异步传输

  > 键盘输入，RS-232异步字符传输

  - RS-232异步字符传输标准

    > 把一串字符串通过铜线进行传输
    >
    > S1:把字符用ASCII码表示出来；S2:

    状态机：电压变化表示状态切换

    > 空闲状态：
    >
    > ​	接受”-“：保持空闲状态
    >
    > ​	接受”+“：变成传输状态
    >
    > 传输状态：
    >
    > ​	接受”-“：保持传输状态，传1
    >
    > ​	接受“+”：保持传输状态，传0
    >
    > 传输的数据前后各需要一位，分别作为起始位(+)、终止位(-)
    >
    > 结束按照“翻转”时间确定，传输完成保持负电压
    >
    > **最终传输到接收方是9位，多一位<u>校验码</u>**

- 同步传输

  > 以太网

  - 原理同对表一样

    > 实现方法：采用先传输一部分规定好的数据，来检测发送方和接收方是否一致

- 等时传输

  > 利用**<u>缓冲区</u>**实现

#### 标准

- 波特率匹配
- 例子：传输Z(0x5A)，检测波特率提高一倍

#### 通信信道

- 单工信道

  > Eg：广播、收音机

- 全双工信道

  - 数据线路设备(DCE)和数据终端设备(DTE)
  - 反接线

- 半双工信道

  > Eg：对讲机

## 调制和调制解调器（第10章）

### 远距离传输

> 考虑：干扰、**<u>信号衰减</u>**
>
> 解决方案：**<u>载波</u>**传输

### 载波传输方式

- 
- 
- 连续性好
- 

### 载波改变方式——调制（Modulation）与解调（Demodulation）

```
S(t)=Asin(2πFt+P)
// A: Amplitude Modulation(调幅)
// F: Frequency Modulation(调频，单位时间内波的个数)
// P: Phase Modulation(调相)
```

- 调幅

  > 调幅的大小有一定的限制（香农定理的限制）

- 调频

- 调相

### 键控（Shift keying）

### 调制技术的比较

> 调相的效率要高一点，变化一次可传输不止一位（通过相位分隔，例如将2π分为8份，则有8种信号，可传输3位数据）

### 正交调幅(QAM, Quadrature Amplitude Modulation)

> 结合调幅和移相键控，使用同时包含相位和振幅的改变来表示数据，QAM最大可以表示1024个
>
> 公式：Y~m~(t) = A~m~sinwt+B~m~coswt，运算为矢量运算

### 调制解调器类型

- 无线猫（RF，Radio Frequency）
- 光纤猫（optical modems）
- 拨号猫（Dialup modem）
  - 拨号调制解调器模式
    - Calling mode
    - Answer mode

## 复用与解复用（第11章）

### 分类

#### 频分多路复用FDM

- 多个逻辑信道，实际上只有一个物理信道。

- 防止频道之间干扰，通常有个区间为防护带区间。

- 信号的漂移现象

  > 解决方法：子信道分配

- 分级FDM

- 分布式平铺

#### 波分多路复用WDM

- 是指应用于光纤中的频分复用技术

#### 时分多路复用TDM

- 同步TDM
  - 问题：空闲时隙
  - 应用：电话通话
- 分级TDM
- 统计TDM
  - 应用：网络
- 逆转复用
  - 将单个高速数字输入被分配到多个低速连接上，传输后再重新复合而形成输入的副本

#### 码分多路复用CDM

- 矢量（Vector）

  > 矢量的运算

- 结论 

## 可靠性和信道编码（第8章）

### 数据传输错误的3个源头

- 干扰
- 失真
- 衰减

### 传输差错对数据的影响

- 单个差错
- 突发差错
- 擦除（模糊）

### 处理信道差错的两种策略（信道编码）

> 发送数据的同时，发送校验码

- 前向纠错（FEC）

- 自动重传请求（ARQ）

### FEC机制

- 单奇偶检验

  > 奇偶性定义为1的个数，且校验位的添加会使得`码字`始终保持`奇数`或``偶数``，保持奇数就是`奇校验`，保持偶数就是`偶校验`.
  >
  > 限制：校验能力有限，出两个错误时便无法校验

- 分组码数学与`（n, k）`表示

- 汉明距离

  > 先计算最小汉明距`d`，而后得出可检查的最大的有效位长度：`E<=d-1`

- 纵横奇偶校验

  > 作用：可以找出错误的位置，并改正错误
  >
  > 缺点：效率低下，一般不用

- 校验和

  > 码的长度一般为字节的倍数，进位需加回到原和中
  >
  > 优点：
  >
  > - 校验和的大小比较小
  > - 计算很简单
  > - 开支很低
  >
  > 缺点：
  >
  > - 对纵向错误无法校验（导致校验和方法一般不用在硬件上）
  >
  > **<u>一般情况下，校验和位取的是算数反码，校验时所有数据位相加，得到结果取补码为0则数据正确</u>**

```
IP包的头部长度：20Bytes
```

- 循环冗余校验码（CRC码，适宜用在硬件上，例如网卡）

  - 关键特性
    - 任意长度报文
    - 出色的检错能力
    - 快速硬件实现

  - 线性码、循环线性码

    > 线性码是一个码的集合C，且C~1~、C~2~∈C，则C~1~、C~2~∈C的线性组合仍然∈C；
    >
    > 循环线性码是指码循环移位后的码仍然属于该集合。

  - 原理

    >

  - 硬件实现

    > 异或门实现基本运算

    - 算法

  - 自动重传请求(ARQ)机制

    > 数据传输成功会发送回执，错误则不发送回执

    ​	

### OSI Reference Model

> **数据流（Data Flow）：**
>
> - Service服务：下一层对上一层提供服务（接口、方法）
> - Protocol协议
> - Physical物理

- 物理层（5 7 9 10 11）

- 数据链路层（8）

  > 将一条物理上有差错的传输信道通过通知和管理而变成逻辑上无差错的

- 

## 因特网应用与网络编程（第3章）

### 线路交换网络（circuit switched network）

### 包交换网络（packet switched network）

  > 特征：轮流

​	

  - 异步

  - 不用安装

> 主要区别在于二者的共享性



## 局域网：分组、帧和拓扑（第13章）

### 以太网的接受方式

  > 广播式：
  >
  > - MAC子层拷贝每个包
  > - LLC子层提取每个包的拷贝
  > - LLC子层只接受那些单一传播、广播或多路传播的地址相匹配的包

### 帧

  > 帧头、帧尾用于检测传输过程是否发生错误，同时用作`边界` 
  >
  > `边界`采用两个ASC码中很少使用的字符： 
  >
  > - SOH（01）头部起始字符
  > - EOT（04）传输结束字符
  >

  - #### 此方案的缺陷

    假如使用此两个字符，将会发生接受解析问题

  - #### 解决方案

    > 字填充（ABC可换成“任意”字符，但是效率不同，找一些不太会出现的字符会提高效率）：
    >
    > - soh → esc + A
    > - eot → esc + B
    > - esc → esc + C

    > 位填充：
    >
    > 5个`1`出现了便插入1个`0`，首尾使用`01111110`作为边界

## IEEE MAC子层（第14章）

### 受控介入协议（Control Access Protocols）

#### 轮询

> 方式：
>
> - 按循环顺序
> - 按优先级顺序
>
> 算法：
>
> ```
> 目的：
> 	通过轮询来控制分组的发送
> 方法：
> 	控制器不断重复{
>         选择站点S，发送一个查询报文给S；
>         等待S发送一个分组来进行响应或跳过；
> 	}
> ```

#### 预定

> 算法：
>
> ```
> 目的：
> 	通过预约来控制分组的发送
> 方法：
> 	控制器不断重复{
>         形成一个需要发送分组的站点列表；
>         允许列表中的站点发送分组；
> 	}
> ```

#### 令牌传递

> `令牌`是一个特殊的`帧`，不管有没有数据都会在环状网络中传输
>
> 令牌有两个状态（`空`和`忙`的切换只能由同一个站点切换）：
>
> - 空 → 可以发送（数据在传输时转变为`忙令牌`） 
> - 忙 → 无法发送（只能当数据在环网中发送一周时，才能将`忙令牌`转换为`空令牌`）

> 算法：
>
> ```
> 目的：
> 	通过令牌传递来控制分组的发送
> 方法：
> 	网络上的每台计算机重复执行{
>         等待令牌的到达；
>         如果本计算机有分组正在等待发送，则发送一个分组；
>         将令牌发送到下一站；
> 	}
> ```
>
> ```
> 1）空令牌传递到下一个节点；
> 2）节点是否要发送？不发送，转向1）
> 3）填充帧到令牌中，并置为忙
> 4）忙令牌传递到下一个节点
> 5）是否接受节点？是，复制该帧；转向4）
> 6）节点是否发送节点？是，销毁令牌中的帧，并置空，返回1）
> 7）返回4）
> ```

### 随机接入协议（Random Access Protocol）

#### ALOHA

#### CSMA/CD（Collision Detect）

> 以太网中一个网卡数据一旦发送，便不能停下，需等到数据发送完
>
> 算法：
>
> ```
> 1）监听网络状态；如果空闲，转向3）
> 2）等待，返回1）
> 3）发送，在发送的过程中同时进行碰撞监听
> 4）一旦发生碰撞，立即停止发送
> 5）推后一个随机时间，返回1）
> ```

检测冲突的方法：

- 载波侦听
- 冲突检测
- 二进制指数退避

#### CSMA/CA（Collision Avoidance）

> 算法：
>
>

## 有限局域网技术（第15章）

### 以太网帧格式

- 以太网帧结构（截自维基百科）

  ![以太网帧格式](/img/image-20181017150353887.png)

> **Question：**(Using 广播 )
>
> How does the sender know the target physical address？（注意：网卡无法识别IP地址）

### 地址解析（Address Resolution）

#### 目的地地址解析

Sender：

- 发送广播，征询目的节点的物理地址

- 接到目的节点应答，取出目的节点物理地址

All Receivers：

- 接到广播，取出源节点物理地址,比较主机名是否相同

- 目标节点，匹配，就取出源节点物理地址，以该地址为目的地址，本物理地址为源地址，作询问应答

- 其他节点，因不匹配不需要作回答

### 帧类型（Frame Type）

> 用于区分帧的类型，是ARP包还是IP包（区分协议类型）

IP：0800

ARP：0806

### IEEE’s 802.3 Ethernet Frame（一种新的帧格式）

### 网卡 NIC Network Interface Card

> NIC可以直接访问Memory，NIC与CPU仅存在指令关系

过程：

- 发送

  > 1. Before sending data,  CPU forms a packet in memory 发送数据之前，CPU在内存中产生一个数据包
  > 2. CPU then instructs the NIC to begin transmission CPU给NIC发送`播送`指令
  > 3. NIC transmits the frame containing the packet
  > 4. After finishing transmission, NIC uses the computer’s interrupt mechanism to inform the CPU

- 接收

  > 1. The NIC waits for a frame to cross the network
  > 2. The NIC makes a copy of the frame
  > 3. The NIC verifies the frame CRC and checks the destination address
  > 4. If the destination address is correct，the NIC stores a copy of the packet  in memory
  > 5. The NIC then interrupts the CPU
  > 6. Otherwise，the NIC discards the frame 

### 网卡产品（NIC Evolution）

#### 粗缆（Original Thick Ethernet Wiring）

![image-20181019161433801](/img/image-20181019161433801.png)

> IEEE802.3
> 10Base5
>
> 最大长度：500m（摩天大楼的高度）

组成：

- 网卡（连在设备上）
- 收发器
- 电缆

> Terminator（终结器）：将信号能量消耗掉，防止信号反弹造成干扰，原理是电阻
>
> Connection Multiplexor（多路连接器）：允许多台计算机连接到单个收发器，且提供与传统收发器完全相同的信号

#### 细缆（Thin Ethernet）

![image-20181019161405925](/img/image-20181019161405925.png)

将前者的三部分组合起来，结构和环网很像，但传输方式仍然是广播式的，Terminator仍然需要。

#### 双绞线以太网（Twisted Pair Ethernet）

![image-20181019161451060](/img/image-20181019161451060.png)

> HUB（集线器）里面包含了主线

### 集成网卡

![image-20181019161615728](/img/image-20181019161615728.png)

- RJ-45：双绞线

- AUI：粗缆

- BNC：细缆

### 双绞线网卡拓扑结构

> Tips：网络上的逻辑上和结构上的拓扑结构可以不同！

物理上：星形结构

逻辑上：总线结构

### 举例：

![image-20181019162644076](/img/image-20181019162644076.png)



### 布线工程

![image-20181019163053138](/img/image-20181019163053138.png)

## 无线联网技术（第16章）

### 个域网（PAN，802.15）

- 蓝牙
- 红外

> 蓝牙耗电比较低，红外耗电高

- 紫峰（ZigBee）
- ISM无线

### 无线局域网（WLAN、WiFi，802.11）

> 为降低信号衰减采用FDM分布式平铺技术（第11章）

> AP，Access Point through the air （Base Station），相当于集线器

#### 类型

- 专门构建型（Ad hoc）

  > 点到点，不通过AP

- 基础结构型（Infrastructure）

  > 通过AP

#### Manet（Mobile Ad-hoc Networks）